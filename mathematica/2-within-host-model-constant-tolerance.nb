(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     45822,        995]
NotebookOptionsPosition[     42313,        931]
NotebookOutlinePosition[     42809,        950]
CellTagsIndexPosition[     42766,        947]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 StyleBox["1. Within-host Dynamics\n",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 "Here is the within-host model. Solve for the endemic virus equilibrium:"
}], "Text",
 CellChangeTimes->{{3.793038922688816*^9, 3.793038926914592*^9}, {
   3.793039135234372*^9, 3.7930391355692453`*^9}, {3.793039172299799*^9, 
   3.7930391891830673`*^9}, {3.7933167139264393`*^9, 3.793316750905744*^9}, {
   3.793317040831243*^9, 3.793317041496848*^9}, {3.793317137484335*^9, 
   3.79331713831961*^9}, {3.793317345506442*^9, 3.793317386604143*^9}, 
   3.793318633240816*^9, 3.7933195602880383`*^9, {3.793545410770094*^9, 
   3.7935454348905163`*^9}, {3.7935456859618607`*^9, 3.793545698490984*^9}, {
   3.7936693206834383`*^9, 3.793669354399426*^9}, {3.793669594744104*^9, 
   3.793669657017395*^9}, {3.793669742229164*^9, 3.793669742721507*^9}, {
   3.821283941213323*^9, 3.8212839759069767`*^9}, {3.821284174676331*^9, 
   3.821284185882245*^9}, {3.8287160224248037`*^9, 3.8287160267666883`*^9}, {
   3.870611096312052*^9, 
   3.8706110970754347`*^9}},ExpressionUUID->"177f5904-4ea3-452b-8b42-\
29a0429fe9c2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"r", "*", "V"}], "-", 
       RowBox[{"c", "*", "V", "*", "L"}]}], "\[Equal]", "0"}], ",", "  ", 
     RowBox[{
      RowBox[{"g0", " ", "+", 
       RowBox[{"g", "*", "r", "*", "V"}], "-", 
       RowBox[{"m", "*", "L"}]}], "\[Equal]", "0"}]}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"V", ",", "L"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.793669321892804*^9, {3.794747937299075*^9, 3.7947479477800303`*^9}, {
   3.794852892051591*^9, 3.794852904827221*^9}, {3.7951079161549892`*^9, 
   3.795107945714861*^9}, {3.7977840818574123`*^9, 3.7977840821104393`*^9}, {
   3.797784710781712*^9, 3.797784720894272*^9}, {3.797786937480184*^9, 
   3.797786941543118*^9}, 3.821283932711665*^9, {3.821283988748959*^9, 
   3.8212840715091963`*^9}, {3.8212841324306793`*^9, 3.821284132730448*^9}, 
   3.8212890421877203`*^9, {3.821289392277177*^9, 3.82128939886172*^9}, {
   3.821289431964966*^9, 3.821289438940608*^9}, {3.821289797575045*^9, 
   3.8212898073700666`*^9}, {3.8212899296564083`*^9, 3.8212899300979233`*^9}, 
   3.8212900303943863`*^9, {3.821290176043159*^9, 3.821290178350466*^9}, 
   3.821290319927436*^9, {3.828705538116147*^9, 3.8287055453310843`*^9}, {
   3.828712281889331*^9, 3.8287123062616053`*^9}, {3.828714506430233*^9, 
   3.828714512585122*^9}, {3.8287149550887413`*^9, 3.828714955459845*^9}, {
   3.828714996008821*^9, 3.828715009812924*^9}, 3.82871903812221*^9, {
   3.828720899091229*^9, 3.8287208995400143`*^9}, {3.864332964526888*^9, 
   3.864332981263093*^9}, {3.86433311954392*^9, 3.8643331199803677`*^9}, {
   3.8643333085324593`*^9, 3.8643333093010817`*^9}, {3.864897013857362*^9, 
   3.8648970146263733`*^9}, {3.8648971527417994`*^9, 3.864897153077993*^9}, {
   3.8650779959212837`*^9, 3.865077996216341*^9}, {3.865080764446913*^9, 
   3.865080765709303*^9}, {3.865080844174477*^9, 3.86508084455875*^9}, {
   3.865333767249968*^9, 3.865333767787566*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"521304a0-bb30-4678-a3fa-1888bca1bba9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"V", "\[Rule]", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"c", " ", "g0"}], "-", 
         RowBox[{"m", " ", "r"}]}], 
        RowBox[{"c", " ", "g", " ", "r"}]]}]}], ",", 
     RowBox[{"L", "\[Rule]", 
      FractionBox["r", "c"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"V", "\[Rule]", "0"}], ",", 
     RowBox[{"L", "\[Rule]", 
      FractionBox["g0", "m"]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.821284075460843*^9, 3.8212841365789547`*^9, 3.821289448625771*^9, 
   3.821289811480888*^9, 3.821289935040988*^9, 3.821290035705059*^9, 
   3.821290188566709*^9, 3.8212903274013033`*^9, 3.8213803314557257`*^9, 
   3.828705551681033*^9, {3.828712298384077*^9, 3.8287123111008663`*^9}, 
   3.8287125323347054`*^9, 3.8287150193006477`*^9, 3.828716034263486*^9, 
   3.828719044353922*^9, 3.828721090173551*^9, 3.828721522460546*^9, 
   3.8295728752151737`*^9, 3.8305168693502207`*^9, 3.86433298815701*^9, 
   3.864333018213484*^9, 3.864333123842781*^9, 3.86433331364186*^9, 
   3.864333929463008*^9, 3.864896935130394*^9, 3.8648970304010973`*^9, 
   3.86489715780132*^9, 3.865007174984337*^9, 3.86507800061279*^9, 
   3.8650807724159737`*^9, {3.865080838100173*^9, 3.8650808486362953`*^9}, 
   3.865333771537251*^9, 3.865337249203807*^9},
 CellLabel->"Out[1]=",ExpressionUUID->"2d9cd7bf-f1de-4935-b4f2-084db582d60e"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Vstar", " ", "=", 
   FractionBox[
    RowBox[{
     RowBox[{"m", "*", "r"}], "-", 
     RowBox[{"c", "*", "g0", " "}]}], 
    RowBox[{"g", "*", "c", "*", "r"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Lstar", " ", "=", " ", 
   FractionBox["r", "c"]}], ";"}]}], "Input",
 CellChangeTimes->{{3.793038949003294*^9, 3.793039002165636*^9}, {
   3.793039106591844*^9, 3.793039112567834*^9}, 3.793039150473567*^9, {
   3.793039197925228*^9, 3.793039246839497*^9}, {3.7930392797550983`*^9, 
   3.793039308710145*^9}, {3.7930393624716187`*^9, 3.7930393970568733`*^9}, 
   3.7933167993160477`*^9, {3.793317404352043*^9, 3.7933174706220303`*^9}, {
   3.7935454501744757`*^9, 3.793545479174035*^9}, {3.7935457165107393`*^9, 
   3.793545751920171*^9}, {3.7936690776841307`*^9, 3.793669085061613*^9}, {
   3.7936691229188623`*^9, 3.793669140339682*^9}, {3.7936692595706463`*^9, 
   3.7936692735760937`*^9}, 3.793669708771627*^9, {3.7947479612046957`*^9, 
   3.794747987280998*^9}, {3.7951079958845778`*^9, 3.795108016734702*^9}, {
   3.797784104895608*^9, 3.797784128542451*^9}, {3.797784727744315*^9, 
   3.797784778121779*^9}, {3.797786955948348*^9, 3.797786979133614*^9}, 
   3.8212839224356728`*^9, {3.821284144850897*^9, 3.8212841698087606`*^9}, {
   3.8212894574461184`*^9, 3.821289459196226*^9}, 3.821289818384822*^9, 
   3.8212899417929993`*^9, 3.8212901949234543`*^9, 3.821290334469561*^9, {
   3.826388943070867*^9, 3.826388948495707*^9}, {3.828705563152779*^9, 
   3.828705564496419*^9}, 3.828712319803977*^9, {3.828715036461232*^9, 
   3.8287150803923883`*^9}, {3.82871905328235*^9, 3.828719055133792*^9}, {
   3.828721104719486*^9, 3.828721108557317*^9}, {3.830516874954262*^9, 
   3.8305168814028463`*^9}, 3.830517800775391*^9, {3.8643330312272673`*^9, 
   3.864333052581732*^9}, {3.864333149425501*^9, 3.864333150858617*^9}, {
   3.8643333214713297`*^9, 3.8643333234852037`*^9}, {3.864897033042741*^9, 
   3.864897033353457*^9}, 3.864897160818996*^9, {3.86507785329736*^9, 
   3.865077854897928*^9}, {3.865078006814966*^9, 3.865078007945034*^9}, 
   3.865080861808202*^9, {3.8653337845221252`*^9, 
   3.865333784964039*^9}},ExpressionUUID->"bfab80c4-fba3-4078-988e-\
2ea20491d65a"],

Cell[TextData[{
 "Now, take those endemic, within-host equilibria and embed them in the \
virulence and transmission terms for the population model -- this gives some \
biological significance to r.  w is motivated as host vulnerability to \
immunopathology (i.e. inflammation), so hosts with higher values for w are \
most susceptible to disease. We can try scaling this as the inverse of host \
lifespan corrected for body size (so values are higher for the shortest-lived \
hosts):\n\n",
 StyleBox["2. Both constant tolerance: ",
  FontWeight->"Bold",
  FontSlant->"Italic"]
}], "Text",
 CellChangeTimes->{{3.821284213632278*^9, 3.8212842583173018`*^9}, {
  3.8212843511859818`*^9, 3.82128448522538*^9}, {3.821288586696447*^9, 
  3.821288697622437*^9}, {3.823636455951353*^9, 3.8236364683897753`*^9}, {
  3.823707411865919*^9, 3.823707415698765*^9}, {3.828712548168633*^9, 
  3.8287125486626883`*^9}, {3.8287150867612743`*^9, 
  3.828715087971443*^9}},ExpressionUUID->"7e041a3d-23bf-45cb-8f20-\
35ddf97acb2f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"BetaT", " ", "=", " ", 
   RowBox[{"zeta", "*", "Vstar"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"alphaT", " ", "=", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"v", "*", "r", "*", 
       RowBox[{"Vstar", "/", "Tv"}]}], ")"}], " ", "+", "  ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"w", "*", 
        RowBox[{"(", 
         RowBox[{"g", "*", "r", "*", "Vstar"}], ")"}]}], ")"}], "/", 
      "Tw"}]}]}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", "BetaT"}], "Input",
 CellChangeTimes->{{3.821284262963787*^9, 3.8212843447433968`*^9}, {
   3.8212929167114353`*^9, 3.821292950190981*^9}, {3.821293006908964*^9, 
   3.8212930107053432`*^9}, {3.8212944603054028`*^9, 3.821294484617671*^9}, {
   3.82129460034933*^9, 3.821294671455904*^9}, {3.821297282221476*^9, 
   3.8212972921178007`*^9}, {3.8212973377294273`*^9, 
   3.8212973384471188`*^9}, {3.821297446182281*^9, 3.821297447132085*^9}, {
   3.821304757581277*^9, 3.821304760689097*^9}, {3.821382212350375*^9, 
   3.821382229755934*^9}, {3.821382289616996*^9, 3.8213822898019047`*^9}, {
   3.8213824454313183`*^9, 3.821382445931765*^9}, {3.821383015377232*^9, 
   3.82138302484908*^9}, {3.821383125088764*^9, 3.8213831338683767`*^9}, {
   3.821386420809463*^9, 3.821386425434841*^9}, {3.823619979191807*^9, 
   3.823619979619602*^9}, {3.823621986665798*^9, 3.823621997299738*^9}, {
   3.8236223312452803`*^9, 3.823622331603949*^9}, 3.8236230007217197`*^9, {
   3.8236330362138643`*^9, 3.823633044182371*^9}, {3.8236332130488367`*^9, 
   3.8236332132333317`*^9}, {3.823635024898142*^9, 3.8236350254301453`*^9}, {
   3.82363648597578*^9, 3.8236364907306843`*^9}, {3.823636607607424*^9, 
   3.823636617804221*^9}, {3.8236435554372997`*^9, 3.823643592401351*^9}, {
   3.823643637250702*^9, 3.823643638432523*^9}, {3.823643675473845*^9, 
   3.82364372037743*^9}, {3.8287125532240887`*^9, 3.828712566828274*^9}, {
   3.828712657208579*^9, 3.828712659682913*^9}, {3.828712784520472*^9, 
   3.828712786851746*^9}, {3.828712866574542*^9, 3.828712874630698*^9}, 
   3.8287159247613287`*^9, {3.828720901982499*^9, 3.828720902193609*^9}, {
   3.828720948356368*^9, 3.828720949890856*^9}, {3.828721202395544*^9, 
   3.8287212072750177`*^9}, 3.831056565275238*^9, 3.8643122296778717`*^9, {
   3.8643319087384043`*^9, 3.864331908981779*^9}, {3.864334062720952*^9, 
   3.8643340657931623`*^9}, {3.8650077408923798`*^9, 3.865007741918435*^9}, {
   3.865080915967471*^9, 3.865080926010817*^9}, 3.865080984807513*^9, {
   3.8650810879216347`*^9, 3.865081091362012*^9}, {3.865324709595327*^9, 
   3.865324725940607*^9}, {3.865324831216127*^9, 3.865324846872797*^9}, {
   3.865330522028028*^9, 3.865330523972095*^9}, {3.865330981186043*^9, 
   3.865331011377263*^9}, {3.865331244122154*^9, 3.8653312679665747`*^9}, {
   3.865331810046792*^9, 3.8653318108864183`*^9}, {3.8653318746828213`*^9, 
   3.865331903505582*^9}, {3.8653325609551086`*^9, 3.865332582557576*^9}, {
   3.865333725921493*^9, 3.865333728057925*^9}, {3.865333758132599*^9, 
   3.865333758447802*^9}, {3.865333832574649*^9, 3.865333833042952*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"26dfaa43-d31b-4bee-9e79-e5491f8efcb2"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "c"}], " ", "g0"}], "+", 
     RowBox[{"m", " ", "r"}]}], ")"}], " ", "zeta"}], 
  RowBox[{"c", " ", "g", " ", "r"}]]], "Output",
 CellChangeTimes->{3.823643695826033*^9, 3.823644537854505*^9, 
  3.828705598782516*^9, 3.828712341548132*^9, 3.828712574568756*^9, 
  3.8287128799146147`*^9, 3.828715101222211*^9, 3.8287160550464582`*^9, 
  3.8287192929231033`*^9, 3.828721120161851*^9, 3.828721250830126*^9, 
  3.828725027136064*^9, 3.8305168962058363`*^9, 3.8305171865554333`*^9, 
  3.831056516987698*^9, 3.86431223327431*^9, 3.864331949774034*^9, 
  3.864333068750866*^9, 3.8643331627251997`*^9, 3.864333346802121*^9, 
  3.864334076060643*^9, 3.8648970450957527`*^9, 3.864897172252429*^9, 
  3.865007193991412*^9, 3.865024115952592*^9, 3.86507802367211*^9, 
  3.8650809347361403`*^9, 3.8650811010289307`*^9, 3.865324783400672*^9, 
  3.865324853503171*^9, 3.8653305372266703`*^9, 3.865331016834609*^9, 
  3.86533355944567*^9, 3.865333803450838*^9, 3.865333843654269*^9, 
  3.865337262843926*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"3bdd8993-f29d-43b9-924b-3b3191adf704"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["alphaT"], "Input",
 CellChangeTimes->{{3.821304822126837*^9, 3.821304823846794*^9}, {
   3.821380353470744*^9, 3.821380356212659*^9}, 3.8236330488033447`*^9, 
   3.865331020285295*^9, 3.865333569136588*^9},
 CellLabel->"In[9]:=",ExpressionUUID->"176ab53c-7a5a-4559-939d-ee1620b0e7b4"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "c"}], " ", "g0"}], "+", 
      RowBox[{"m", " ", "r"}]}], ")"}], " ", "v"}], 
   RowBox[{"c", " ", "g", " ", "Tv"}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "c"}], " ", "g0"}], "+", 
      RowBox[{"m", " ", "r"}]}], ")"}], " ", "w"}], 
   RowBox[{"c", " ", "Tw"}]]}]], "Output",
 CellChangeTimes->{{3.865333565556979*^9, 3.865333572267076*^9}, 
   3.865333807305249*^9, 3.86533384819746*^9, 3.8653372675735807`*^9},
 CellLabel->"Out[9]=",ExpressionUUID->"4c34011e-73d1-4973-bebe-e3dfd373b215"]
}, Open  ]],

Cell["\<\
Now, embed these transmission and virulence terms in the invasion fitness for \
a population-level S-I model:\
\>", "Text",
 CellChangeTimes->{{3.8212845191306543`*^9, 
  3.821284564680831*^9}},ExpressionUUID->"dc8f89b9-7ae2-417b-b835-\
c009c7bba5fb"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"InvasionFit", "=", " ", 
   RowBox[{"BetaT", "/", 
    RowBox[{"(", 
     RowBox[{"mu", " ", "+", "  ", "alphaT"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", "InvasionFit", "]"}]}], "Input",
 CellChangeTimes->{{3.8212846484098053`*^9, 3.8212846616422443`*^9}, {
   3.8212847051936274`*^9, 3.8212847297760344`*^9}, {3.821284913259995*^9, 
   3.8212849136332073`*^9}, {3.821286075325266*^9, 3.8212860758955717`*^9}, {
   3.8212890792731237`*^9, 3.821289079483115*^9}, {3.8212898897633743`*^9, 
   3.821289890923201*^9}, {3.82129294706111*^9, 3.821292947264412*^9}, 
   3.8212947489973707`*^9, 3.821295031171177*^9, 3.821297451111265*^9, {
   3.82137832030095*^9, 3.821378325666315*^9}, {3.8213783627111397`*^9, 
   3.821378367982416*^9}, 3.821382241090781*^9, 3.8213823975644836`*^9, 
   3.828705615342276*^9, {3.829573977912735*^9, 3.8295739820977497`*^9}, 
   3.864312247448985*^9, {3.8650811117386007`*^9, 3.865081112355769*^9}, 
   3.865324804248642*^9, {3.865331042088032*^9, 3.865331048275363*^9}, {
   3.865333590139188*^9, 3.8653336001164427`*^9}, 3.865333852797258*^9, 
   3.865337272700045*^9},
 CellLabel->"In[6]:=",ExpressionUUID->"46ee1b19-3f93-4ca9-8b06-9123cc40cf78"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "c"}], " ", "g0"}], "+", 
     RowBox[{"m", " ", "r"}]}], ")"}], " ", "Tv", " ", "Tw", " ", "zeta"}], 
  RowBox[{
   RowBox[{"r", " ", "Tw", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", "g", " ", "mu", " ", "Tv"}], "-", 
      RowBox[{"c", " ", "g0", " ", "v"}], "+", 
      RowBox[{"m", " ", "r", " ", "v"}]}], ")"}]}], "+", 
   RowBox[{"g", " ", "r", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "c"}], " ", "g0"}], "+", 
      RowBox[{"m", " ", "r"}]}], ")"}], " ", "Tv", " ", "w"}]}]]], "Output",
 CellChangeTimes->{{3.8213783576039257`*^9, 3.821378370985016*^9}, 
   3.821378414861693*^9, 3.821380382922552*^9, 3.821382247538538*^9, {
   3.8213823878301353`*^9, 3.8213824045142403`*^9}, 3.8213824693587646`*^9, 
   3.8213830608254623`*^9, 3.8213831485905743`*^9, 3.821386457984523*^9, 
   3.823620015158242*^9, 3.823622040221468*^9, 3.823622389396891*^9, 
   3.823623028604487*^9, 3.823623138044963*^9, 3.82363307117248*^9, 
   3.8236332373390903`*^9, 3.823635061054134*^9, 3.823636650321661*^9, 
   3.823643755502594*^9, 3.8236445472320147`*^9, 3.8237074359026814`*^9, 
   3.823708510653573*^9, 3.826388969632715*^9, 3.8266376222179317`*^9, 
   3.826640945616043*^9, 3.828705625922454*^9, 3.828712365526762*^9, 
   3.82871259553942*^9, 3.828712673339168*^9, 3.8287127993897457`*^9, 
   3.828712894939416*^9, 3.828715182983287*^9, 3.8287160778338413`*^9, 
   3.828719315036779*^9, 3.8287211471605663`*^9, 3.8287212685873404`*^9, 
   3.828725046394445*^9, 3.829572954350094*^9, 3.8295739857755117`*^9, 
   3.83051693322999*^9, 3.830517203171526*^9, 3.830517820462336*^9, 
   3.832609554132506*^9, 3.8643122531062737`*^9, 3.8643273454706173`*^9, 
   3.86433196237368*^9, 3.864333082099214*^9, 3.864333173868985*^9, 
   3.8643333618584633`*^9, 3.864334089194271*^9, 3.864896957850739*^9, 
   3.864897055551467*^9, 3.8648971950346193`*^9, 3.86500720522512*^9, 
   3.865024130111627*^9, 3.865078045122217*^9, 3.865080953727112*^9, 
   3.865081120109473*^9, {3.8653247975348463`*^9, 3.865324809012043*^9}, 
   3.8653248669035873`*^9, 3.8653305486145067`*^9, 3.8653310546198072`*^9, 
   3.865331291129795*^9, 3.865333607131558*^9, 3.8653338148584557`*^9, 
   3.865333859471713*^9, 3.8653372758875523`*^9, 3.86534282924831*^9},
 CellLabel->"Out[7]=",ExpressionUUID->"4ebc65c2-7cb9-4806-8dfd-559d16898ca1"]
}, Open  ]],

Cell[TextData[{
 StyleBox["2. Selection gradient on r",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 "\nAnd now, differentiate with respect to r to get this for dInvasion \
Fitness/dr:"
}], "Text",
 CellChangeTimes->{{3.8212847994954977`*^9, 3.8212848172423267`*^9}, {
  3.821284852050622*^9, 3.821284857680869*^9}, {3.8212850348858347`*^9, 
  3.821285042153496*^9}, {3.821285287158844*^9, 3.8212852988907213`*^9}, {
  3.8213881207720833`*^9, 3.8213881291952953`*^9}, {3.8326101121188717`*^9, 
  3.832610113013946*^9}},ExpressionUUID->"5b869029-2c89-49a7-9abd-\
5a050fbf11b8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"partialD", " ", "=", " ", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"D", "[", 
     RowBox[{"InvasionFit", ",", "r"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"partialD", " "}]}], "Input",
 CellChangeTimes->{{3.8212850445881367`*^9, 3.8212850486404953`*^9}, {
   3.8212852529964314`*^9, 3.821285274862822*^9}, {3.821289101101653*^9, 
   3.821289108429842*^9}, {3.821289162741458*^9, 3.82128917977724*^9}, {
   3.821289504600141*^9, 3.821289508384932*^9}, {3.821289898837006*^9, 
   3.821289904988904*^9}, {3.821289966344494*^9, 3.821289971270709*^9}, {
   3.821290234736329*^9, 3.821290237925228*^9}, 3.821294506826068*^9, 
   3.821295043059643*^9, 3.8212973098136253`*^9, 3.821297352852243*^9, {
   3.821297388581874*^9, 3.821297416716383*^9}, 3.821297460867958*^9, 
   3.821378429482476*^9, 3.8213804080634527`*^9, 3.821382265408896*^9, 
   3.821382410501595*^9, 3.821382475701634*^9, 3.821383067346015*^9, 
   3.821383154204515*^9, 3.821386583770512*^9, 3.8236200359268007`*^9, 
   3.823622046505917*^9, 3.823622395939926*^9, {3.823623565569895*^9, 
   3.8236235692304697`*^9}, {3.8236330801456223`*^9, 3.823633084938477*^9}, 
   3.823633244963839*^9, 3.8236350669549913`*^9, 3.8236366556368713`*^9, {
   3.823643763603405*^9, 3.8236437648588533`*^9}, 3.82638933876717*^9, 
   3.8266376283646603`*^9, 3.82664095069172*^9, {3.828705634620228*^9, 
   3.828705637000423*^9}, 3.828712373423473*^9, {3.828712603222165*^9, 
   3.8287126042971497`*^9}, 3.8287126800731564`*^9, 3.828712804931931*^9, 
   3.828712900706479*^9, 3.8287151887990828`*^9, 3.8287160858249207`*^9, 
   3.828719322914949*^9, 3.828721156595908*^9, 3.828721275384507*^9, {
   3.828725052957902*^9, 3.828725054466751*^9}, 3.82957310352304*^9, {
   3.829573995437182*^9, 3.829574002769318*^9}, 3.8305169408285637`*^9, 
   3.8305172108985786`*^9, {3.8309938325792828`*^9, 3.8309938761719637`*^9}, {
   3.830994095726866*^9, 3.830994112718069*^9}, {3.864312372424979*^9, 
   3.8643123757246857`*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"b84430ad-d26e-41bc-a480-7b9f85f8e79a"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"Tv", " ", "Tw", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["c", "2"]}], " ", "g", " ", "g0", " ", "mu", " ", "Tv",
        " ", "Tw"}], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", " ", "g0"}], "-", 
          RowBox[{"m", " ", "r"}]}], ")"}], "2"], " ", "Tw", " ", "v"}], "+", 
      
      RowBox[{"g", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", " ", "g0"}], "-", 
          RowBox[{"m", " ", "r"}]}], ")"}], "2"], " ", "Tv", " ", "w"}]}], 
     ")"}], " ", "zeta"}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"r", " ", "Tw", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", "g", " ", "mu", " ", "Tv"}], "-", 
         RowBox[{"c", " ", "g0", " ", "v"}], "+", 
         RowBox[{"m", " ", "r", " ", "v"}]}], ")"}]}], "+", 
      RowBox[{"g", " ", "r", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "c"}], " ", "g0"}], "+", 
         RowBox[{"m", " ", "r"}]}], ")"}], " ", "Tv", " ", "w"}]}], ")"}], 
    "2"]]}]], "Output",
 CellChangeTimes->CompressedData["
1:eJwdz1sog2EYwPGNHHL4TOFGsjEuNK0krRZ5pVw5UygpWW1rmqQQboTNFn2Y
aHIsX7bm/NGcQiTNLgjZBcvhQumVaBdyfh4X/37Xf0mtvkQlFAgESsjIdvk+
2imJE3rEn+BDvVePtqhuV9CUkvMKQQclihNeh3KMpkgIvnYex/iBPp2IDQB5
/2FOCqqfH2VJoEillOV0UnLUkaPeAtVp10E7YHGzJ3W+h5IJr7V5CTSkWy2o
c8s3jo7H9c6jQxmFG6hEeXC1DD7UfN2h78mLeSsgx1Vdr4JhCsc+DzZp607R
rkH73DrIJDC7ZUZKzqO98nLQv6jUKjFRYjmr2UYT+nxtIWZK5n7FY+j2iDtv
xEVJSGXu6AS4cyn2TIEmTVbdNNiYaNWj7E22Ac36LrhHee29kz+BvyvP4b8z
kcwaOBlv63sCwwyKszfQlc7+oFquWhrupmQmsJZlwAhz5iwaHHUx3Q3abSIb
2pYf2mAEK16WF1BHps6NKhsGnnvB1D17kAnc1MWGoxa5zGkGC6caW/vBPzC8
AEQ=
  "],
 CellLabel->"Out[10]=",ExpressionUUID->"89681ae8-f8bb-4232-a658-c5c6e3a4631e"]
}, Open  ]],

Cell["And then set equal to 0 and solve for r*", "Text",
 CellChangeTimes->{{3.821285314885951*^9, 
  3.821285328925426*^9}},ExpressionUUID->"8c0a6322-b4b3-470b-8229-\
ca2cb5541f37"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"partialD", " ", "\[Equal]", "0"}], "}"}], ",", 
    RowBox[{"{", "r", "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8212853335571213`*^9, 3.821285352032818*^9}, {
   3.8212891258765163`*^9, 3.821289158833363*^9}, {3.8212891912460957`*^9, 
   3.821289225041904*^9}, {3.8212895164303217`*^9, 3.821289517168058*^9}, 
   3.821289913258857*^9, 3.821289977727961*^9, {3.8212902544925423`*^9, 
   3.821290256565546*^9}, {3.8212903823313217`*^9, 3.821290383474334*^9}, 
   3.821292977518033*^9, 3.821293040982518*^9, 3.821294519074646*^9, {
   3.821294728662487*^9, 3.821294729076832*^9}, {3.8212950575670757`*^9, 
   3.8212950582989492`*^9}, 3.821297321099547*^9, 3.821297430603698*^9, 
   3.821297475286965*^9, 3.821378441526425*^9, 3.821380437380796*^9, 
   3.8213822804448233`*^9, 3.821382424309712*^9, 3.8213824875054817`*^9, 
   3.821383079111074*^9, 3.821383165013524*^9, 3.8213865966541157`*^9, {
   3.8236200543286867`*^9, 3.8236200615975647`*^9}, {3.8236220640682898`*^9, 
   3.82362206495966*^9}, 3.823622416491067*^9, 3.823623047135783*^9, {
   3.823623583401849*^9, 3.823623587504529*^9}, {3.823633112319736*^9, 
   3.823633117349206*^9}, {3.823633260171485*^9, 3.8236332612772207`*^9}, 
   3.823635089099896*^9, 3.823636670597678*^9, 3.823643790290801*^9, {
   3.823708528474605*^9, 3.82370852998829*^9}, 3.826389622086643*^9, 
   3.8266376425046883`*^9, 3.828705655974847*^9, {3.8287123890791693`*^9, 
   3.828712390999406*^9}, 3.8287126206847277`*^9, 3.828712694580225*^9, {
   3.8287128183972178`*^9, 3.828712818819668*^9}, 3.8287129126812773`*^9, {
   3.8287152055288343`*^9, 3.828715207981855*^9}, {3.828715263748455*^9, 
   3.828715288231268*^9}, 3.828716099757227*^9, 3.82871933794141*^9, 
   3.828721179658805*^9, 3.828721294086282*^9, {3.8287250709595747`*^9, 
   3.82872507267276*^9}, {3.8295731337463503`*^9, 3.829573140891616*^9}, {
   3.829574028197619*^9, 3.829574038401472*^9}, {3.8305169593911047`*^9, 
   3.8305169610225*^9}, {3.830517228388791*^9, 3.830517242555032*^9}, {
   3.8309939084213133`*^9, 3.830994023657114*^9}, 3.830994183960374*^9, {
   3.831056636548744*^9, 3.831056638445241*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"374123e7-bf4e-4c65-8bbb-160d7e2734a0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"r", "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{"c", " ", "g0", " ", "m"}], "-", 
       FractionBox[
        SqrtBox[
         RowBox[{
          SuperscriptBox["c", "2"], " ", "g", " ", "g0", " ", 
          SuperscriptBox["m", "2"], " ", "mu", " ", "Tv", " ", "Tw", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Tw", " ", "v"}], "+", 
            RowBox[{"g", " ", "Tv", " ", "w"}]}], ")"}]}]], 
        RowBox[{
         RowBox[{"Tw", " ", "v"}], "+", 
         RowBox[{"g", " ", "Tv", " ", "w"}]}]]}], 
      SuperscriptBox["m", "2"]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"r", "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{"c", " ", "g0", " ", "m"}], "+", 
       FractionBox[
        SqrtBox[
         RowBox[{
          SuperscriptBox["c", "2"], " ", "g", " ", "g0", " ", 
          SuperscriptBox["m", "2"], " ", "mu", " ", "Tv", " ", "Tw", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Tw", " ", "v"}], "+", 
            RowBox[{"g", " ", "Tv", " ", "w"}]}], ")"}]}]], 
        RowBox[{
         RowBox[{"Tw", " ", "v"}], "+", 
         RowBox[{"g", " ", "Tv", " ", "w"}]}]]}], 
      SuperscriptBox["m", "2"]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8212973247562037`*^9, 3.821297435637117*^9, 3.821297478940927*^9, 
   3.821378445540566*^9, 3.821380445239511*^9, 3.821382284104212*^9, 
   3.821382428331419*^9, 3.821382492098566*^9, 3.8213830830415792`*^9, 
   3.821383169328755*^9, 3.821386600960661*^9, 3.823620067343772*^9, 
   3.8236220710926113`*^9, 3.823622420648233*^9, 3.8236230511292343`*^9, 
   3.823623591407682*^9, 3.8236331233205357`*^9, 3.8236332671701517`*^9, 
   3.823635092895253*^9, 3.8236366750086*^9, 3.823643795201151*^9, 
   3.823707461179111*^9, 3.823708535142623*^9, 3.8263896258068447`*^9, 
   3.826637647432029*^9, 3.828705660447651*^9, 3.8287126256375113`*^9, 
   3.828712698561198*^9, 3.828712824309259*^9, 3.8287130677036*^9, 
   3.8287152982677298`*^9, {3.828716103510356*^9, 3.8287161293812647`*^9}, 
   3.8287193425400047`*^9, 3.828721183664064*^9, 3.8287213045112047`*^9, 
   3.82872507879091*^9, 3.8295731455982122`*^9, 3.829574042690136*^9, 
   3.830516965562635*^9, 3.830517246993039*^9, 3.830517833563665*^9, 
   3.830994031795147*^9, 3.830994206364956*^9, 3.831056642866295*^9, 
   3.832609571787866*^9, 3.8326331571630697`*^9, 3.864313165530159*^9, 
   3.8643274775816317`*^9, 3.864331977440157*^9, 3.864333102003326*^9, 
   3.864333191272828*^9, 3.864333386659438*^9, 3.86433410565613*^9, 
   3.86489697559776*^9, 3.864898000422009*^9, 3.865024143155984*^9, 
   3.865024624971814*^9, 3.865078059194811*^9, 3.865080968679014*^9, 
   3.8650811625998774`*^9, 3.865324819697831*^9, 3.865324882710726*^9, 
   3.865330566789948*^9, 3.8653310676683493`*^9, 3.8653313069620447`*^9, 
   3.865333617888895*^9, 3.865333826212174*^9, 3.865333872649498*^9, 
   3.865337286056595*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"12dac474-42bc-4001-bcae-861799989668"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"rstar", " ", "=", " ", 
    FractionBox[
     RowBox[{
      RowBox[{"c", " ", "g0", " ", "m"}], "+", 
      FractionBox[
       SqrtBox[
        RowBox[{
         SuperscriptBox["c", "2"], " ", "g", " ", "g0", " ", 
         SuperscriptBox["m", "2"], " ", "mu", " ", "Tv", " ", "Tw", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Tw", " ", "v"}], "+", 
           RowBox[{"g", " ", "Tv", " ", "w"}]}], ")"}]}]], 
       RowBox[{
        RowBox[{"Tw", " ", "v"}], "+", 
        RowBox[{"g", " ", "Tv", " ", "w"}]}]]}], 
     SuperscriptBox["m", "2"]]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.821295312388266*^9, 3.821295320681725*^9}, {
   3.8212974890450163`*^9, 3.821297491355426*^9}, {3.821382518550596*^9, 
   3.8213825469305487`*^9}, 3.821387125137822*^9, {3.821387529084181*^9, 
   3.821387554202915*^9}, {3.821387607688798*^9, 3.821387619000194*^9}, {
   3.821388072259606*^9, 3.821388073747068*^9}, 3.8236200787564697`*^9, 
   3.823622082326508*^9, 3.823622427937187*^9, 3.823633130651388*^9, 
   3.8236332740762167`*^9, 3.823635106878119*^9, 3.823636688163596*^9, 
   3.823643802293385*^9, {3.826637653150446*^9, 3.826637654259605*^9}, {
   3.828705674693851*^9, 3.8287057313970118`*^9}, {3.828715312081912*^9, 
   3.8287153178526087`*^9}, 3.828716145544055*^9, 3.828719355197933*^9, 
   3.8287213135148563`*^9, {3.830517013072616*^9, 3.8305170634958887`*^9}, {
   3.830517850034898*^9, 3.8305178715818644`*^9}, 3.864313173482218*^9, 
   3.864331997996402*^9, {3.8643332201937437`*^9, 3.864333243188067*^9}, {
   3.8643341214862413`*^9, 3.8643341265845423`*^9}, {3.864898216330604*^9, 
   3.864898235186714*^9}, 3.865078077012089*^9, 3.865081180894846*^9, 
   3.8653249192894773`*^9, 
   3.865333895279806*^9},ExpressionUUID->"863f96d5-380a-4ecf-8a13-\
1daaab0a28d0"],

Cell[TextData[{
 StyleBox["3. Checking stability\n",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 "We can check that rstar is convergence stable and therefore a CSS by \
checking that the second derivative of d/dr is negative at rstar:"
}], "Text",
 CellChangeTimes->{
  3.831056847380151*^9},ExpressionUUID->"0665ea31-2271-42a9-9a3c-\
5f67f91013f7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"secondD", " ", "=", " ", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"D", "[", 
     RowBox[{"partialD", " ", ",", " ", "r"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", "secondD"}], "Input",
 CellChangeTimes->{{3.823635354388711*^9, 3.823635400181183*^9}, 
   3.823636890053796*^9, {3.82663683651892*^9, 3.826636902164568*^9}, {
   3.829573202825098*^9, 3.829573207479438*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"58b062d0-9ac7-4185-bdeb-fbe9f461e693"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"2", " ", "Tv", " ", "Tw", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"3", " ", "c", " ", "g0", " ", 
         SuperscriptBox["m", "2"], " ", 
         SuperscriptBox["r", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Tw", " ", "v"}], "+", 
            RowBox[{"g", " ", "Tv", " ", "w"}]}], ")"}], "2"]}], "-", 
        RowBox[{
         SuperscriptBox["m", "3"], " ", 
         SuperscriptBox["r", "3"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Tw", " ", "v"}], "+", 
            RowBox[{"g", " ", "Tv", " ", "w"}]}], ")"}], "2"]}], "-", 
        RowBox[{"3", " ", 
         SuperscriptBox["c", "2"], " ", "g0", " ", "m", " ", "r", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Tw", " ", "v"}], "+", 
           RowBox[{"g", " ", "Tv", " ", "w"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"g0", " ", "Tw", " ", "v"}], "+", 
           RowBox[{"g", " ", "Tv", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "mu"}], " ", "Tw"}], "+", 
              RowBox[{"g0", " ", "w"}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["c", "3"], " ", "g0", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g0", " ", "Tw", " ", "v"}], "+", 
            RowBox[{"g", " ", "Tv", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "mu"}], " ", "Tw"}], "+", 
               RowBox[{"g0", " ", "w"}]}], ")"}]}]}], ")"}], "2"]}]}], ")"}], 
      " ", "zeta"}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["r", "3"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "c"}], " ", "g0", " ", "Tw", " ", "v"}], "+", 
         RowBox[{"c", " ", "g", " ", "Tv", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"mu", " ", "Tw"}], "-", 
            RowBox[{"g0", " ", "w"}]}], ")"}]}], "+", 
         RowBox[{"m", " ", "r", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Tw", " ", "v"}], "+", 
            RowBox[{"g", " ", "Tv", " ", "w"}]}], ")"}]}]}], ")"}], "3"]}], 
     ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.8266376667221823`*^9, 3.82870574239088*^9, 3.828715344333673*^9, 
   3.828716205548441*^9, 3.828721322792206*^9, 3.828725098328876*^9, 
   3.829573212482003*^9, 3.8295740767903347`*^9, {3.830517073501196*^9, 
   3.830517082185981*^9}, 3.83051728204237*^9, 3.8305178841747017`*^9, 
   3.864313390792799*^9, 3.864327625770033*^9, 3.8643320104427233`*^9, 
   3.864334145811487*^9, 3.864898518720059*^9, 3.865024632488042*^9, 
   3.86507822406017*^9, 3.865324961695548*^9, 3.865337292789713*^9},
 CellLabel->"Out[20]=",ExpressionUUID->"80b574a1-eaa6-4a66-8126-48bc7878f51f"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"r", "=", " ", "rstar"}], ";"}]], "Input",
 CellChangeTimes->{{3.826636915778458*^9, 3.8266369199564447`*^9}, {
  3.826637684708199*^9, 
  3.826637707064796*^9}},ExpressionUUID->"ec91610e-b48c-4ba5-9f5a-\
8513cc2ee306"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", "secondD", "]"}]], "Input",
 CellChangeTimes->{{3.826636942976356*^9, 3.826636946537797*^9}, 
   3.82663771461629*^9, {3.828705763522434*^9, 3.828705774674223*^9}, {
   3.828715359162409*^9, 3.8287153667815847`*^9}, {3.828721338677421*^9, 
   3.82872134033403*^9}, {3.828725110385808*^9, 3.82872511241578*^9}, {
   3.829573231990945*^9, 3.829573241859997*^9}, {3.829574091148733*^9, 
   3.8295740923395367`*^9}, {3.830517097136982*^9, 3.830517098225116*^9}, {
   3.830517296464492*^9, 3.830517298158616*^9}, {3.864313406456059*^9, 
   3.864313407216817*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"c070f702-fd58-4703-baf9-4cf9bb118e6e"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"2", " ", 
      SuperscriptBox["c", "2"], " ", "g", " ", "g0", " ", 
      SuperscriptBox["m", "8"], " ", "mu", " ", 
      SuperscriptBox["Tv", "2"], " ", 
      SuperscriptBox["Tw", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Tw", " ", "v"}], "+", 
         RowBox[{"g", " ", "Tv", " ", "w"}]}], ")"}], "3"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["c", "2"], " ", "g", " ", "g0", " ", 
           SuperscriptBox["m", "2"], " ", "mu", " ", "Tv", " ", "Tw", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Tw", " ", "v"}], "+", 
             RowBox[{"g", " ", "Tv", " ", "w"}]}], ")"}]}]]}], "+", 
        RowBox[{"c", " ", "m", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"g0", " ", "Tw", " ", "v"}], "+", 
           RowBox[{"g", " ", "Tv", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"mu", " ", "Tw"}], "+", 
              RowBox[{"g0", " ", "w"}]}], ")"}]}]}], ")"}]}]}], ")"}], " ", 
      "zeta"}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", "g", " ", "m", " ", "mu", " ", "Tv", " ", "Tw"}], 
         "+", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["c", "2"], " ", "g", " ", "g0", " ", 
           SuperscriptBox["m", "2"], " ", "mu", " ", "Tv", " ", "Tw", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Tw", " ", "v"}], "+", 
             RowBox[{"g", " ", "Tv", " ", "w"}]}], ")"}]}]]}], ")"}], "3"], 
      " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", "g0", " ", "m", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Tw", " ", "v"}], "+", 
            RowBox[{"g", " ", "Tv", " ", "w"}]}], ")"}]}], "+", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["c", "2"], " ", "g", " ", "g0", " ", 
           SuperscriptBox["m", "2"], " ", "mu", " ", "Tv", " ", "Tw", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Tw", " ", "v"}], "+", 
             RowBox[{"g", " ", "Tv", " ", "w"}]}], ")"}]}]]}], ")"}], "3"]}], 
     ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.864313412702936*^9, 3.864327646925552*^9, 3.8643320187325573`*^9, 
   3.864334156490419*^9, 3.864898570439793*^9, 3.865024648098895*^9, 
   3.865024694183165*^9, {3.865078230246975*^9, 3.865078253435701*^9}, 
   3.865324968221246*^9, 3.8653373012228518`*^9},
 CellLabel->"Out[22]=",ExpressionUUID->"ec4ca93b-dc34-45ae-a2ad-b14daa0531f0"]
}, Open  ]],

Cell[TextData[{
 StyleBox["This expression is clearly negative (also supported by the PIP), \
meaning that rstar is an  ESS.\n\n\n",
  FontWeight->"Bold"],
 StyleBox["4. Virulence at optimal r* in the reservoir host.\n",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 "We can also use the expression for r* to calculate an expression for \
alpha*, the virulence experienced by the reservoir host at optimal r*. To do \
this, we simply plug the within-host parameters into our expression for \
alpha, assuming r=r*.\n\nThis yields the following expression:"
}], "Text",
 CellChangeTimes->{{3.826637044394709*^9, 3.826637056997521*^9}, {
  3.826637736292523*^9, 3.826637758582646*^9}, {3.826640408869451*^9, 
  3.8266404983697567`*^9}, {3.828715387579402*^9, 3.828715406064753*^9}, {
  3.8287196798791513`*^9, 3.828719698230646*^9}, {3.829574150830886*^9, 
  3.8295741776765614`*^9}, {3.8305171141952353`*^9, 3.830517152095656*^9}, {
  3.830517340748398*^9, 3.8305173555126743`*^9}, {3.864313431259791*^9, 
  3.864313453880742*^9}, {3.8643277305789022`*^9, 
  3.864327734561915*^9}},ExpressionUUID->"21e88b2a-303c-4a9c-9bc6-\
8333aec685ce"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", "alphaT", "]"}]], "Input",
 CellChangeTimes->{{3.826640510719016*^9, 3.8266405107226048`*^9}, {
  3.826640980665881*^9, 3.826640998924466*^9}, {3.829573261527671*^9, 
  3.829573266149323*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"8f98ce15-a057-42c3-a837-5c6a5a31daa6"],

Cell[BoxData[
 FractionBox[
  RowBox[{"c", " ", "g0", " ", "m", " ", "mu", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Tw", " ", "v"}], "+", 
     RowBox[{"g", " ", "Tv", " ", "w"}]}], ")"}]}], 
  SqrtBox[
   RowBox[{
    SuperscriptBox["c", "2"], " ", "g", " ", "g0", " ", 
    SuperscriptBox["m", "2"], " ", "mu", " ", "Tv", " ", "Tw", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Tw", " ", "v"}], "+", 
      RowBox[{"g", " ", "Tv", " ", "w"}]}], ")"}]}]]]], "Output",
 CellChangeTimes->{{3.826640991261487*^9, 3.826641002066814*^9}, 
   3.8287058457591352`*^9, 3.8287154104893723`*^9, 3.828720767043852*^9, 
   3.828720801895109*^9, 3.828721362388649*^9, 3.829573269796994*^9, 
   3.829574184903976*^9, 3.830517417756254*^9, 3.830517898612838*^9, 
   3.8326098105156927`*^9, 3.86431363528692*^9, 3.864327747378463*^9, 
   3.864332027364469*^9, 3.8643341681209183`*^9, 3.8648985807903976`*^9, 
   3.865024656432732*^9, 3.865024699732109*^9, {3.865078235273142*^9, 
   3.865078258148881*^9}, 3.8653249735099783`*^9, 3.865337306188426*^9},
 CellLabel->"Out[23]=",ExpressionUUID->"88b51a5a-4046-45eb-bddd-79a20be93aa8"]
}, Open  ]],

Cell[TextData[{
 "alpha* = ",
 Cell[BoxData[
  FractionBox[
   RowBox[{"c", " ", "g0", " ", "m", " ", "mu", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Tw", " ", "v"}], "+", 
      RowBox[{"g", " ", "Tv", " ", "w"}]}], ")"}]}], 
   SqrtBox[
    RowBox[{
     SuperscriptBox["c", "2"], " ", "g", " ", "g0", " ", 
     SuperscriptBox["m", "2"], " ", "mu", " ", "Tv", " ", "Tw", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Tw", " ", "v"}], "+", 
       RowBox[{"g", " ", "Tv", " ", "w"}]}], ")"}]}]]]],
  CellChangeTimes->{{3.826640991261487*^9, 3.826641002066814*^9}, 
    3.8287058457591352`*^9, 3.8287154104893723`*^9, 3.828720767043852*^9, 
    3.828720801895109*^9, 3.828721362388649*^9, 3.829573269796994*^9, 
    3.829574184903976*^9, 3.830517417756254*^9, 3.830517898612838*^9, 
    3.8326098105156927`*^9, 3.86431363528692*^9, 3.864327747378463*^9, 
    3.864332027364469*^9, 3.8643341681209183`*^9, 3.8648985807903976`*^9, 
    3.865024656432732*^9, 3.865024699732109*^9, {3.865078235273142*^9, 
    3.865078258148881*^9}, 3.8653249735099783`*^9},ExpressionUUID->
  "0d1c9090-c6d4-4834-a027-acd603ae8e7f"]
}], "Text",
 CellChangeTimes->{{3.826641020542989*^9, 3.826641026779117*^9}, {
   3.828705852311903*^9, 3.828705927451527*^9}, 3.828715425238872*^9, 
   3.828720807296582*^9, {3.8287213698972673`*^9, 3.828721369897377*^9}, {
   3.830517429648217*^9, 3.830517460653741*^9}, {3.830517912230969*^9, 
   3.830517912231031*^9}, 3.864313650783784*^9, 3.864332032454564*^9, 
   3.864334174389675*^9, {3.864898589429018*^9, 3.8648985894290657`*^9}, 
   3.865078268045415*^9, 3.865324982231196*^9, {3.8653373134069567`*^9, 
   3.86533731370994*^9}},ExpressionUUID->"32bcf582-ac3d-4fec-89da-\
b137da2c8e24"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.829573938395267*^9, 
  3.829573956024825*^9}},ExpressionUUID->"73990abf-1c17-4b80-b5f5-\
95fa5985300d"]
},
WindowSize->{849, 735},
WindowMargins->{{29, Automatic}, {Automatic, 3}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
TaggingRules->Association["TryRealOnly" -> False],
FrontEndVersion->"12.3 for Mac OS X ARM (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"a2653741-2f87-47ab-9179-c92c478adacd"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1113, 19, 58, "Text",ExpressionUUID->"177f5904-4ea3-452b-8b42-29a0429fe9c2"],
Cell[CellGroupData[{
Cell[1696, 43, 2097, 37, 30, "Input",ExpressionUUID->"521304a0-bb30-4678-a3fa-1888bca1bba9"],
Cell[3796, 82, 1464, 32, 53, "Output",ExpressionUUID->"2d9cd7bf-f1de-4935-b4f2-084db582d60e"]
}, Open  ]],
Cell[5275, 117, 2235, 37, 88, "Input",ExpressionUUID->"bfab80c4-fba3-4078-988e-2ea20491d65a"],
Cell[7513, 156, 1012, 18, 150, "Text",ExpressionUUID->"7e041a3d-23bf-45cb-8f20-35ddf97acb2f"],
Cell[CellGroupData[{
Cell[8550, 178, 3222, 53, 94, "Input",ExpressionUUID->"26dfaa43-d31b-4bee-9e79-e5491f8efcb2"],
Cell[11775, 233, 1174, 22, 53, "Output",ExpressionUUID->"3bdd8993-f29d-43b9-924b-3b3191adf704"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12986, 260, 298, 4, 30, "Input",ExpressionUUID->"176ab53c-7a5a-4559-939d-ee1620b0e7b4"],
Cell[13287, 266, 673, 20, 53, "Output",ExpressionUUID->"4c34011e-73d1-4973-bebe-e3dfd373b215"]
}, Open  ]],
Cell[13975, 289, 261, 6, 35, "Text",ExpressionUUID->"dc8f89b9-7ae2-417b-b835-c009c7bba5fb"],
Cell[CellGroupData[{
Cell[14261, 299, 1249, 21, 52, "Input",ExpressionUUID->"46ee1b19-3f93-4ca9-8b06-9123cc40cf78"],
Cell[15513, 322, 2449, 45, 53, "Output",ExpressionUUID->"4ebc65c2-7cb9-4806-8dfd-559d16898ca1"]
}, Open  ]],
Cell[17977, 370, 578, 12, 58, "Text",ExpressionUUID->"5b869029-2c89-49a7-9abd-5a050fbf11b8"],
Cell[CellGroupData[{
Cell[18580, 386, 2101, 33, 52, "Input",ExpressionUUID->"b84430ad-d26e-41bc-a480-7b9f85f8e79a"],
Cell[20684, 421, 1906, 52, 107, "Output",ExpressionUUID->"89681ae8-f8bb-4232-a658-c5c6e3a4631e"]
}, Open  ]],
Cell[22605, 476, 182, 3, 35, "Text",ExpressionUUID->"8c0a6322-b4b3-470b-8229-ca2cb5541f37"],
Cell[CellGroupData[{
Cell[22812, 483, 2321, 35, 30, "Input",ExpressionUUID->"374123e7-bf4e-4c65-8bbb-160d7e2734a0"],
Cell[25136, 520, 3072, 64, 67, "Output",ExpressionUUID->"12dac474-42bc-4001-bcae-861799989668"]
}, Open  ]],
Cell[28223, 587, 1871, 37, 91, "Input",ExpressionUUID->"863f96d5-380a-4ecf-8a13-1daaab0a28d0"],
Cell[30097, 626, 352, 9, 81, "Text",ExpressionUUID->"0665ea31-2271-42a9-9a3c-5f67f91013f7"],
Cell[CellGroupData[{
Cell[30474, 639, 501, 10, 52, "Input",ExpressionUUID->"58b062d0-9ac7-4185-bdeb-fbe9f461e693"],
Cell[30978, 651, 3051, 79, 83, "Output",ExpressionUUID->"80b574a1-eaa6-4a66-8126-48bc7878f51f"]
}, Open  ]],
Cell[34044, 733, 253, 6, 30, "Input",ExpressionUUID->"ec91610e-b48c-4ba5-9f5a-8513cc2ee306"],
Cell[CellGroupData[{
Cell[34322, 743, 681, 10, 30, "Input",ExpressionUUID->"c070f702-fd58-4703-baf9-4cf9bb118e6e"],
Cell[35006, 755, 2773, 74, 130, "Output",ExpressionUUID->"ec4ca93b-dc34-45ae-a2ad-b14daa0531f0"]
}, Open  ]],
Cell[37794, 832, 1138, 20, 196, "Text",ExpressionUUID->"21e88b2a-303c-4a9c-9bc6-8333aec685ce"],
Cell[CellGroupData[{
Cell[38957, 856, 315, 5, 30, "Input",ExpressionUUID->"8f98ce15-a057-42c3-a837-5c6a5a31daa6"],
Cell[39275, 863, 1133, 23, 57, "Output",ExpressionUUID->"88b51a5a-4046-45eb-bddd-79a20be93aa8"]
}, Open  ]],
Cell[40423, 889, 1731, 35, 46, "Text",ExpressionUUID->"32bcf582-ac3d-4fec-89da-b137da2c8e24"],
Cell[42157, 926, 152, 3, 30, "Input",ExpressionUUID->"73990abf-1c17-4b80-b5f5-95fa5985300d"]
}
]
*)

