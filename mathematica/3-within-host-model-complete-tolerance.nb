(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     41795,        958]
NotebookOptionsPosition[     38447,        897]
NotebookOutlinePosition[     38879,        914]
CellTagsIndexPosition[     38836,        911]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 StyleBox["1. Within-host Dynamics\n",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 "Here is the within-host model. Solve for the endemic virus equilibrium:"
}], "Text",
 CellChangeTimes->{{3.793038922688816*^9, 3.793038926914592*^9}, {
   3.793039135234372*^9, 3.7930391355692453`*^9}, {3.793039172299799*^9, 
   3.7930391891830673`*^9}, {3.7933167139264393`*^9, 3.793316750905744*^9}, {
   3.793317040831243*^9, 3.793317041496848*^9}, {3.793317137484335*^9, 
   3.79331713831961*^9}, {3.793317345506442*^9, 3.793317386604143*^9}, 
   3.793318633240816*^9, 3.7933195602880383`*^9, {3.793545410770094*^9, 
   3.7935454348905163`*^9}, {3.7935456859618607`*^9, 3.793545698490984*^9}, {
   3.7936693206834383`*^9, 3.793669354399426*^9}, {3.793669594744104*^9, 
   3.793669657017395*^9}, {3.793669742229164*^9, 3.793669742721507*^9}, {
   3.821283941213323*^9, 3.8212839759069767`*^9}, {3.821284174676331*^9, 
   3.821284185882245*^9}},ExpressionUUID->"177f5904-4ea3-452b-8b42-\
29a0429fe9c2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"r", "*", "V"}], "-", 
       RowBox[{"c", "*", "V", "*", "L"}]}], "\[Equal]", "0"}], ",", "  ", 
     RowBox[{
      RowBox[{"g0", " ", "+", 
       RowBox[{"g", "*", "r", "*", "V"}], "-", 
       RowBox[{"m", "*", "L"}]}], "\[Equal]", "0"}]}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"V", ",", "L"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.793669321892804*^9, {3.794747937299075*^9, 3.7947479477800303`*^9}, {
   3.794852892051591*^9, 3.794852904827221*^9}, {3.7951079161549892`*^9, 
   3.795107945714861*^9}, {3.7977840818574123`*^9, 3.7977840821104393`*^9}, {
   3.797784710781712*^9, 3.797784720894272*^9}, {3.797786937480184*^9, 
   3.797786941543118*^9}, 3.821283932711665*^9, {3.821283988748959*^9, 
   3.8212840715091963`*^9}, {3.8212841324306793`*^9, 3.821284132730448*^9}, 
   3.8212890421877203`*^9, {3.821289392277177*^9, 3.82128939886172*^9}, {
   3.821289431964966*^9, 3.821289438940608*^9}, {3.821289797575045*^9, 
   3.8212898073700666`*^9}, {3.8212899296564083`*^9, 3.8212899300979233`*^9}, 
   3.8212900303943863`*^9, {3.821290176043159*^9, 3.821290178350466*^9}, 
   3.821290319927436*^9, {3.8287214079761057`*^9, 3.828721410400136*^9}, 
   3.828721458023134*^9, 3.864899258442874*^9, {3.8653373389667883`*^9, 
   3.865337339356675*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"521304a0-bb30-4678-a3fa-1888bca1bba9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"V", "\[Rule]", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"c", " ", "g0"}], "-", 
         RowBox[{"m", " ", "r"}]}], 
        RowBox[{"c", " ", "g", " ", "r"}]]}]}], ",", 
     RowBox[{"L", "\[Rule]", 
      FractionBox["r", "c"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"V", "\[Rule]", "0"}], ",", 
     RowBox[{"L", "\[Rule]", 
      FractionBox["g0", "m"]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.821284075460843*^9, 3.8212841365789547`*^9, 
  3.821289448625771*^9, 3.821289811480888*^9, 3.821289935040988*^9, 
  3.821290035705059*^9, 3.821290188566709*^9, 3.8212903274013033`*^9, 
  3.8213803314557257`*^9, 3.828721415987197*^9, 3.828721467953102*^9, 
  3.828721540779049*^9, 3.830518185108138*^9, 3.864899261522287*^9, 
  3.864899355209025*^9, 3.864899669627075*^9, 3.865010987120714*^9, 
  3.865337463502637*^9},
 CellLabel->"Out[1]=",ExpressionUUID->"4844756f-0760-4775-81b5-4938fcbfecd9"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Vstar", " ", "=", 
   FractionBox[
    RowBox[{
     RowBox[{"m", "*", "r"}], "-", 
     RowBox[{"c", "*", "g0", " "}]}], 
    RowBox[{"g", "*", "c", "*", "r"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Lstar", " ", "=", " ", 
   FractionBox["r", "c"]}], ";"}]}], "Input",
 CellChangeTimes->{{3.793038949003294*^9, 3.793039002165636*^9}, {
   3.793039106591844*^9, 3.793039112567834*^9}, 3.793039150473567*^9, {
   3.793039197925228*^9, 3.793039246839497*^9}, {3.7930392797550983`*^9, 
   3.793039308710145*^9}, {3.7930393624716187`*^9, 3.7930393970568733`*^9}, 
   3.7933167993160477`*^9, {3.793317404352043*^9, 3.7933174706220303`*^9}, {
   3.7935454501744757`*^9, 3.793545479174035*^9}, {3.7935457165107393`*^9, 
   3.793545751920171*^9}, {3.7936690776841307`*^9, 3.793669085061613*^9}, {
   3.7936691229188623`*^9, 3.793669140339682*^9}, {3.7936692595706463`*^9, 
   3.7936692735760937`*^9}, 3.793669708771627*^9, {3.7947479612046957`*^9, 
   3.794747987280998*^9}, {3.7951079958845778`*^9, 3.795108016734702*^9}, {
   3.797784104895608*^9, 3.797784128542451*^9}, {3.797784727744315*^9, 
   3.797784778121779*^9}, {3.797786955948348*^9, 3.797786979133614*^9}, 
   3.8212839224356728`*^9, {3.821284144850897*^9, 3.8212841698087606`*^9}, {
   3.8212894574461184`*^9, 3.821289459196226*^9}, 3.821289818384822*^9, 
   3.8212899417929993`*^9, 3.8212901949234543`*^9, 3.821290334469561*^9, {
   3.828721550256043*^9, 3.828721564933023*^9}, {3.830518192576066*^9, 
   3.8305181978156767`*^9}, {3.864899377838708*^9, 3.864899384639842*^9}, {
   3.8653374661813583`*^9, 
   3.8653374665721407`*^9}},ExpressionUUID->"bfab80c4-fba3-4078-988e-\
2ea20491d65a"],

Cell[TextData[{
 "Now, take those endemic, within-host equilibria and embed them in the \
virulence and transmission terms for the population model -- this gives some \
biological significance to r.  w is motivated as host vulnerability to \
immunopathology (i.e. inflammation), so hosts with higher values for w are \
most susceptible to disease. We can try scaling this as the inverse of host \
lifespan corrected for body size (so values are higher for the shortest-lived \
hosts):\n\n2. ",
 StyleBox["First, both complete tolerance: ",
  FontWeight->"Bold"]
}], "Text",
 CellChangeTimes->{{3.821284213632278*^9, 3.8212842583173018`*^9}, {
  3.8212843511859818`*^9, 3.82128448522538*^9}, {3.821288586696447*^9, 
  3.821288697622437*^9}, {3.823636455951353*^9, 
  3.8236364683897753`*^9}},ExpressionUUID->"7e041a3d-23bf-45cb-8f20-\
35ddf97acb2f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"BetaT", " ", "=", " ", 
   RowBox[{"zeta", "*", "Vstar"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"alphaT", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"v", "-", "Tv"}], ")"}], "*", "r", "*", "Vstar"}], ")"}], " ", 
    "+", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"w", "-", "Tw"}], ")"}], "*", "g", "*", "r", "*", "Vstar"}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", "BetaT"}], "Input",
 CellChangeTimes->{{3.821284262963787*^9, 3.8212843447433968`*^9}, {
   3.8212929167114353`*^9, 3.821292950190981*^9}, {3.821293006908964*^9, 
   3.8212930107053432`*^9}, {3.8212944603054028`*^9, 3.821294484617671*^9}, {
   3.82129460034933*^9, 3.821294671455904*^9}, {3.821297282221476*^9, 
   3.8212972921178007`*^9}, {3.8212973377294273`*^9, 
   3.8212973384471188`*^9}, {3.821297446182281*^9, 3.821297447132085*^9}, {
   3.821304757581277*^9, 3.821304760689097*^9}, {3.821382212350375*^9, 
   3.821382229755934*^9}, {3.821382289616996*^9, 3.8213822898019047`*^9}, {
   3.8213824454313183`*^9, 3.821382445931765*^9}, {3.821383015377232*^9, 
   3.82138302484908*^9}, {3.821383125088764*^9, 3.8213831338683767`*^9}, {
   3.821386420809463*^9, 3.821386425434841*^9}, {3.823619979191807*^9, 
   3.823619979619602*^9}, {3.823621986665798*^9, 3.823621997299738*^9}, {
   3.8236223312452803`*^9, 3.823622331603949*^9}, 3.8236230007217197`*^9, {
   3.8236330362138643`*^9, 3.823633044182371*^9}, {3.8236332130488367`*^9, 
   3.8236332132333317`*^9}, {3.823635024898142*^9, 3.8236350254301453`*^9}, {
   3.82363648597578*^9, 3.8236364907306843`*^9}, {3.823636607607424*^9, 
   3.823636617804221*^9}, {3.823707487630571*^9, 3.823707496403338*^9}, {
   3.828721575487851*^9, 3.828721576997572*^9}, 3.864230053208675*^9, {
   3.864899395786026*^9, 3.864899442210149*^9}, {3.865337526922634*^9, 
   3.865337530773782*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"26dfaa43-d31b-4bee-9e79-e5491f8efcb2"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "c"}], " ", "g0"}], "+", 
     RowBox[{"m", " ", "r"}]}], ")"}], " ", "zeta"}], 
  RowBox[{"c", " ", "g", " ", "r"}]]], "Output",
 CellChangeTimes->{3.8648996846629267`*^9, 3.865011011720727*^9, 
  3.865023751227153*^9, 3.8650257680258703`*^9, 3.865337481131872*^9, 
  3.8653444426018467`*^9},
 CellLabel->"Out[7]=",ExpressionUUID->"99faa22d-d13e-475b-ac4c-549f598e4783"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"alphaT", " "}]], "Input",
 CellChangeTimes->{{3.821304822126837*^9, 3.821304823846794*^9}, {
   3.821380353470744*^9, 3.821380356212659*^9}, 3.8236330488033447`*^9, 
   3.8287269662868433`*^9},
 CellLabel->"In[8]:=",ExpressionUUID->"176ab53c-7a5a-4559-939d-ee1620b0e7b4"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "c"}], " ", "g0"}], "+", 
      RowBox[{"m", " ", "r"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "Tv"}], "+", "v"}], ")"}]}], 
   RowBox[{"c", " ", "g"}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "c"}], " ", "g0"}], "+", 
      RowBox[{"m", " ", "r"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "Tw"}], "+", "w"}], ")"}]}], "c"]}]], "Output",
 CellChangeTimes->{3.8236199953791227`*^9, 3.823622013803804*^9, 
  3.823622366306219*^9, 3.823623013312599*^9, 3.823633056906934*^9, 
  3.823633226170795*^9, 3.823635041382183*^9, 3.8236366363741817`*^9, 
  3.826390435011483*^9, 3.828721591143648*^9, 3.828726858731166*^9, 
  3.828726970041174*^9, 3.828818803958061*^9, 3.830518216692443*^9, 
  3.8642300651004257`*^9, 3.864314189778821*^9, 3.8648996896245203`*^9, 
  3.865011016556982*^9, 3.8650238153443527`*^9, 3.865025773173394*^9, 
  3.8653374864819517`*^9, 3.8653375376290207`*^9, 3.865344447882189*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"6bf90735-4776-4f35-9043-76d3f5970042"]
}, Open  ]],

Cell["\<\
Now, embed these transmission and virulence terms in the invasion fitness for \
a population-level S-I model:\
\>", "Text",
 CellChangeTimes->{{3.8212845191306543`*^9, 
  3.821284564680831*^9}},ExpressionUUID->"dc8f89b9-7ae2-417b-b835-\
c009c7bba5fb"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"InvasionFit", "=", " ", 
   RowBox[{"BetaT", "/", 
    RowBox[{"(", 
     RowBox[{"mu", " ", "+", " ", "alphaT"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", "InvasionFit", "]"}]}], "Input",
 CellChangeTimes->{{3.8212846484098053`*^9, 3.8212846616422443`*^9}, {
   3.8212847051936274`*^9, 3.8212847297760344`*^9}, {3.821284913259995*^9, 
   3.8212849136332073`*^9}, {3.821286075325266*^9, 3.8212860758955717`*^9}, {
   3.8212890792731237`*^9, 3.821289079483115*^9}, {3.8212898897633743`*^9, 
   3.821289890923201*^9}, {3.82129294706111*^9, 3.821292947264412*^9}, 
   3.8212947489973707`*^9, 3.821295031171177*^9, 3.821297451111265*^9, {
   3.82137832030095*^9, 3.821378325666315*^9}, {3.8213783627111397`*^9, 
   3.821378367982416*^9}, 3.821382241090781*^9, 3.8213823975644836`*^9, {
   3.829575440259726*^9, 3.829575445684086*^9}, {3.864230078432583*^9, 
   3.864230080957966*^9}, 3.865344451653356*^9},
 CellLabel->"In[11]:=",ExpressionUUID->"46ee1b19-3f93-4ca9-8b06-9123cc40cf78"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"c", " ", "g0"}], "-", 
     RowBox[{"m", " ", "r"}]}], ")"}], " ", "zeta"}], 
  RowBox[{"r", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"m", " ", "r", " ", 
      RowBox[{"(", 
       RowBox[{"Tv", "+", 
        RowBox[{"g", " ", "Tw"}], "-", "v", "-", 
        RowBox[{"g", " ", "w"}]}], ")"}]}], "-", 
     RowBox[{"c", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"g0", " ", 
         RowBox[{"(", 
          RowBox[{"Tv", "-", "v"}], ")"}]}], "+", 
        RowBox[{"g", " ", 
         RowBox[{"(", 
          RowBox[{"mu", "+", 
           RowBox[{"g0", " ", "Tw"}], "-", 
           RowBox[{"g0", " ", "w"}]}], ")"}]}]}], ")"}]}]}], 
    ")"}]}]]], "Output",
 CellChangeTimes->{3.826637898830368*^9, 3.826637940336043*^9, 
  3.826641355995418*^9, 3.8287216039333353`*^9, 3.8287269812045794`*^9, 
  3.828818817318446*^9, 3.8295754501599913`*^9, 3.830518229445384*^9, 
  3.832610352093539*^9, 3.832610482959958*^9, 3.832633398167757*^9, 
  3.864230096264613*^9, 3.864234358862145*^9, 3.864235371867083*^9, 
  3.8643141978096933`*^9, 3.864326201406732*^9, 3.864899698285535*^9, 
  3.864900732691111*^9, 3.864902436908576*^9, 3.865011023717152*^9, 
  3.865025781805429*^9, 3.865337493809387*^9, 3.86533754401388*^9, 
  3.865344455747334*^9},
 CellLabel->"Out[12]=",ExpressionUUID->"7e8c4160-0814-4f97-aecf-06637d4da4d3"]
}, Open  ]],

Cell[TextData[{
 StyleBox["2. Selection gradient on r",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 "\nAnd now, differentiate with respect to r to get this for dInvasion Fit/dr:"
}], "Text",
 CellChangeTimes->{{3.8212847994954977`*^9, 3.8212848172423267`*^9}, {
  3.821284852050622*^9, 3.821284857680869*^9}, {3.8212850348858347`*^9, 
  3.821285042153496*^9}, {3.821285287158844*^9, 3.8212852988907213`*^9}, {
  3.8213881207720833`*^9, 
  3.8213881291952953`*^9}},ExpressionUUID->"5b869029-2c89-49a7-9abd-\
5a050fbf11b8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"partialD", " ", "=", " ", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"D", "[", 
     RowBox[{"InvasionFit", ",", "r"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"partialD", " "}]}], "Input",
 CellChangeTimes->{{3.8212850445881367`*^9, 3.8212850486404953`*^9}, {
   3.8212852529964314`*^9, 3.821285274862822*^9}, {3.821289101101653*^9, 
   3.821289108429842*^9}, {3.821289162741458*^9, 3.82128917977724*^9}, {
   3.821289504600141*^9, 3.821289508384932*^9}, {3.821289898837006*^9, 
   3.821289904988904*^9}, {3.821289966344494*^9, 3.821289971270709*^9}, {
   3.821290234736329*^9, 3.821290237925228*^9}, 3.821294506826068*^9, 
   3.821295043059643*^9, 3.8212973098136253`*^9, 3.821297352852243*^9, {
   3.821297388581874*^9, 3.821297416716383*^9}, 3.821297460867958*^9, 
   3.821378429482476*^9, 3.8213804080634527`*^9, 3.821382265408896*^9, 
   3.821382410501595*^9, 3.821382475701634*^9, 3.821383067346015*^9, 
   3.821383154204515*^9, 3.821386583770512*^9, 3.8236200359268007`*^9, 
   3.823622046505917*^9, 3.823622395939926*^9, {3.823623565569895*^9, 
   3.8236235692304697`*^9}, {3.8236330801456223`*^9, 3.823633084938477*^9}, 
   3.823633244963839*^9, 3.8236350669549913`*^9, 3.8236366556368713`*^9, 
   3.823707547927516*^9, 3.826390042849101*^9, 3.826390112092897*^9, 
   3.826390473772181*^9, {3.826637959278552*^9, 3.8266379608027353`*^9}, 
   3.82872161396446*^9, {3.828726994328476*^9, 3.828726996153039*^9}, 
   3.828818826061408*^9, {3.8295754612574472`*^9, 3.829575463383819*^9}, {
   3.829575679739902*^9, 3.829575684846958*^9}, {3.830518238983798*^9, 
   3.8305182403081837`*^9}, {3.8326334023584223`*^9, 3.832633435580222*^9}, 
   3.864230254672928*^9, {3.864230322195005*^9, 3.864230382115213*^9}, {
   3.864230419789123*^9, 3.864230421807096*^9}, 3.8642353837189837`*^9, {
   3.864314211695101*^9, 3.864314215836515*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"b84430ad-d26e-41bc-a480-7b9f85f8e79a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["m", "2"], " ", 
       SuperscriptBox["r", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"Tv", "+", 
         RowBox[{"g", " ", "Tw"}], "-", "v", "-", 
         RowBox[{"g", " ", "w"}]}], ")"}]}], "+", 
      RowBox[{"2", " ", "c", " ", "g0", " ", "m", " ", "r", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "Tv"}], "-", 
         RowBox[{"g", " ", "Tw"}], "+", "v", "+", 
         RowBox[{"g", " ", "w"}]}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["c", "2"], " ", "g0", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g0", " ", 
          RowBox[{"(", 
           RowBox[{"Tv", "-", "v"}], ")"}]}], "+", 
         RowBox[{"g", " ", 
          RowBox[{"(", 
           RowBox[{"mu", "+", 
            RowBox[{"g0", " ", "Tw"}], "-", 
            RowBox[{"g0", " ", "w"}]}], ")"}]}]}], ")"}]}]}], ")"}], " ", 
    "zeta"}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["r", "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", " ", "g0", " ", 
        RowBox[{"(", 
         RowBox[{"Tv", "-", "v"}], ")"}]}], "+", 
       RowBox[{"c", " ", "g", " ", 
        RowBox[{"(", 
         RowBox[{"mu", "+", 
          RowBox[{"g0", " ", 
           RowBox[{"(", 
            RowBox[{"Tw", "-", "w"}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"m", " ", "r", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "Tv"}], "+", "v", "+", 
          RowBox[{"g", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "Tw"}], "+", "w"}], ")"}]}]}], ")"}]}]}], ")"}], 
     "2"]}], ")"}]}]], "Output",
 CellChangeTimes->{3.823622052142643*^9, 3.823622406750136*^9, 
  3.823623038950914*^9, 3.8236235750123863`*^9, 3.82363309460378*^9, 
  3.823633253649807*^9, 3.823635075283038*^9, 3.823636662265984*^9, 
  3.823707558352633*^9, 3.826390049810156*^9, 3.826390131547106*^9, 
  3.82639048387318*^9, 3.8266372527530212`*^9, 3.826637972254631*^9, 
  3.828721620771371*^9, 3.82872700341194*^9, 3.82881883338659*^9, 
  3.8295754738769083`*^9, 3.829575744958496*^9, 3.830518246380519*^9, 
  3.8326104947851973`*^9, 3.83263344780097*^9, 3.864230503488113*^9, 
  3.8642343697813396`*^9, 3.8642353874325113`*^9, 3.864314221160632*^9, 
  3.864326208349666*^9, 3.864899705369122*^9, 3.8649007387093678`*^9, 
  3.8649021844137497`*^9, 3.864902442424679*^9, 3.86501104036944*^9, 
  3.865025827141858*^9, 3.865337499749165*^9, 3.865337549746793*^9, 
  3.865344465298892*^9},
 CellLabel->"Out[15]=",ExpressionUUID->"b951dfad-1179-4416-beab-e2edd2e745d4"]
}, Open  ]],

Cell["And then set equal to 0 and solve for r*", "Text",
 CellChangeTimes->{{3.821285314885951*^9, 
  3.821285328925426*^9}},ExpressionUUID->"8c0a6322-b4b3-470b-8229-\
ca2cb5541f37"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"partialD", "\[Equal]", "0"}], "}"}], ",", 
    RowBox[{"{", "r", "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8212853335571213`*^9, 3.821285352032818*^9}, {
   3.8212891258765163`*^9, 3.821289158833363*^9}, {3.8212891912460957`*^9, 
   3.821289225041904*^9}, {3.8212895164303217`*^9, 3.821289517168058*^9}, 
   3.821289913258857*^9, 3.821289977727961*^9, {3.8212902544925423`*^9, 
   3.821290256565546*^9}, {3.8212903823313217`*^9, 3.821290383474334*^9}, 
   3.821292977518033*^9, 3.821293040982518*^9, 3.821294519074646*^9, {
   3.821294728662487*^9, 3.821294729076832*^9}, {3.8212950575670757`*^9, 
   3.8212950582989492`*^9}, 3.821297321099547*^9, 3.821297430603698*^9, 
   3.821297475286965*^9, 3.821378441526425*^9, 3.821380437380796*^9, 
   3.8213822804448233`*^9, 3.821382424309712*^9, 3.8213824875054817`*^9, 
   3.821383079111074*^9, 3.821383165013524*^9, 3.8213865966541157`*^9, {
   3.8236200543286867`*^9, 3.8236200615975647`*^9}, {3.8236220640682898`*^9, 
   3.82362206495966*^9}, 3.823622416491067*^9, 3.823623047135783*^9, {
   3.823623583401849*^9, 3.823623587504529*^9}, {3.823633112319736*^9, 
   3.823633117349206*^9}, {3.823633260171485*^9, 3.8236332612772207`*^9}, 
   3.823635089099896*^9, 3.823636670597678*^9, 3.8237075666344423`*^9, 
   3.826390748091177*^9, 3.826637910101309*^9, 3.8266380253273563`*^9, {
   3.828721628824842*^9, 3.828721630191565*^9}, {3.828727012377645*^9, 
   3.828727014657137*^9}, {3.8288188408895397`*^9, 3.8288188417319183`*^9}, {
   3.829575759366551*^9, 3.82957576347259*^9}, {3.829575830777375*^9, 
   3.8295758322440653`*^9}, {3.830518254800666*^9, 3.8305182563585443`*^9}, 
   3.832610689620919*^9, {3.832633457803255*^9, 3.8326334649600763`*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"374123e7-bf4e-4c65-8bbb-160d7e2734a0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"r", "\[Rule]", 
     FractionBox[
      RowBox[{"c", " ", "g0", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         FractionBox[
          RowBox[{"c", " ", "g", " ", "m", " ", "mu"}], 
          SqrtBox[
           RowBox[{
            SuperscriptBox["c", "2"], " ", "g", " ", "g0", " ", 
            SuperscriptBox["m", "2"], " ", "mu", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "Tv"}], "-", 
              RowBox[{"g", " ", "Tw"}], "+", "v", "+", 
              RowBox[{"g", " ", "w"}]}], ")"}]}]]]}], ")"}]}], "m"]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"r", "\[Rule]", 
     FractionBox[
      RowBox[{"c", " ", "g0", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         FractionBox[
          RowBox[{"c", " ", "g", " ", "m", " ", "mu"}], 
          SqrtBox[
           RowBox[{
            SuperscriptBox["c", "2"], " ", "g", " ", "g0", " ", 
            SuperscriptBox["m", "2"], " ", "mu", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "Tv"}], "-", 
              RowBox[{"g", " ", "Tw"}], "+", "v", "+", 
              RowBox[{"g", " ", "w"}]}], ")"}]}]]]}], ")"}]}], "m"]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8212973247562037`*^9, 3.821297435637117*^9, 3.821297478940927*^9, 
   3.821378445540566*^9, 3.821380445239511*^9, 3.821382284104212*^9, 
   3.821382428331419*^9, 3.821382492098566*^9, 3.8213830830415792`*^9, 
   3.821383169328755*^9, 3.821386600960661*^9, 3.823620067343772*^9, 
   3.8236220710926113`*^9, 3.823622420648233*^9, 3.8236230511292343`*^9, 
   3.823623591407682*^9, 3.8236331233205357`*^9, 3.8236332671701517`*^9, 
   3.823635092895253*^9, 3.8236366750086*^9, 3.823707571165874*^9, 
   3.8263907524300413`*^9, 3.826638029951954*^9, 3.828721636561831*^9, 
   3.828727019336741*^9, 3.828818846114506*^9, 3.8295758504917717`*^9, 
   3.8305182614423637`*^9, 3.8326106995765963`*^9, 3.832633469816024*^9, 
   3.8642313542771873`*^9, 3.864234375064464*^9, 3.8642353935846157`*^9, 
   3.864314241905794*^9, 3.864326217090188*^9, 3.864899712189744*^9, {
   3.8648998982648706`*^9, 3.8648999132478848`*^9}, 3.864900745380321*^9, 
   3.864902452127199*^9, 3.865011047370772*^9, 3.865025833442974*^9, 
   3.865337506582594*^9, 3.865337557623879*^9},
 CellLabel->"Out[25]=",ExpressionUUID->"a3fa38a3-7e5e-46e6-9caa-17f749d79bf3"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"rstar", " ", "=", 
    FractionBox[
     RowBox[{"c", " ", "g0", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        FractionBox[
         RowBox[{"c", " ", "g", " ", "m", " ", "mu"}], 
         SqrtBox[
          RowBox[{
           SuperscriptBox["c", "2"], " ", "g", " ", "g0", " ", 
           SuperscriptBox["m", "2"], " ", "mu", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "Tv"}], "-", 
             RowBox[{"g", " ", "Tw"}], "+", "v", "+", 
             RowBox[{"g", " ", "w"}]}], ")"}]}]]]}], ")"}]}], "m"]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.821295312388266*^9, 3.821295320681725*^9}, {
   3.8212974890450163`*^9, 3.821297491355426*^9}, {3.821382518550596*^9, 
   3.8213825469305487`*^9}, 3.821387125137822*^9, {3.821387529084181*^9, 
   3.821387554202915*^9}, {3.821387607688798*^9, 3.821387619000194*^9}, {
   3.821388072259606*^9, 3.821388073747068*^9}, 3.8236200787564697`*^9, 
   3.823622082326508*^9, 3.823622427937187*^9, 3.823633130651388*^9, 
   3.8236332740762167`*^9, 3.823635106878119*^9, 3.823636688163596*^9, 
   3.823707579649664*^9, {3.823707781959323*^9, 3.823707801303988*^9}, {
   3.8263907783370647`*^9, 3.826390779396332*^9}, {3.82639084989583*^9, 
   3.826390851707429*^9}, {3.8287217004837837`*^9, 3.828721762879058*^9}, {
   3.8287270480991497`*^9, 3.828727063740479*^9}, {3.828818863371233*^9, 
   3.828818863836666*^9}, {3.830518277243348*^9, 3.8305183179869347`*^9}, {
   3.830518355872507*^9, 3.830518433546093*^9}, {3.832610723204961*^9, 
   3.8326107518971786`*^9}, {3.832633500640091*^9, 3.832633520055592*^9}, 
   3.8642317352114277`*^9, {3.864233109266633*^9, 3.8642332774195623`*^9}, {
   3.864234053527546*^9, 3.8642341980461082`*^9}, {3.8642343829434757`*^9, 
   3.864234643563189*^9}, {3.864234680248322*^9, 3.864234835607134*^9}, {
   3.864234992854574*^9, 3.864235021615734*^9}, {3.8642352961582212`*^9, 
   3.864235342435951*^9}, {3.864235402651853*^9, 3.8642354911116*^9}, {
   3.864235528476892*^9, 3.8642355491223793`*^9}, {3.864235597221676*^9, 
   3.864235726141797*^9}, {3.864314258730667*^9, 3.864314271328536*^9}, {
   3.864325417098003*^9, 3.8643254671905737`*^9}, {3.864326222424367*^9, 
   3.8643262473888493`*^9}, 3.864900279784388*^9, {3.864900349552503*^9, 
   3.864900350684251*^9}, 3.865025994955617*^9, 
   3.865337568887107*^9},ExpressionUUID->"863f96d5-380a-4ecf-8a13-\
1daaab0a28d0"],

Cell[TextData[{
 StyleBox["3. Checking stability",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 "\nWe can check if rstar is convergence stable and therefore an ESS by \
taking the second derivative of the invasion fitness with respect to r and \
evaluating at r* : is it negative?"
}], "Text",
 CellChangeTimes->{{3.821285691138969*^9, 3.821285777220462*^9}, {
   3.821289548530711*^9, 3.8212897924560833`*^9}, {3.821290406374948*^9, 
   3.821290466796156*^9}, {3.821292987588456*^9, 3.8212929922262573`*^9}, {
   3.821293107824596*^9, 3.821293203455114*^9}, {3.8212932958812103`*^9, 
   3.821293314887054*^9}, {3.821293446086234*^9, 3.821293467057708*^9}, {
   3.821293665069602*^9, 3.821293761185729*^9}, {3.821293798532536*^9, 
   3.821294128604212*^9}, {3.821294160811644*^9, 3.82129416920228*^9}, {
   3.821294248331234*^9, 3.821294433273554*^9}, {3.8212950825005627`*^9, 
   3.821295124487192*^9}, {3.821295154733152*^9, 3.821295264187851*^9}, {
   3.821302884162829*^9, 3.821302891372984*^9}, {3.821387662213025*^9, 
   3.821387720160944*^9}, {3.8213878305076017`*^9, 3.821387901804961*^9}, {
   3.821387946138321*^9, 3.821387953051119*^9}, {3.821388026366804*^9, 
   3.821388064005672*^9}, {3.821388137240576*^9, 3.821388146916957*^9}, {
   3.821393417407905*^9, 3.821393425709292*^9}, {3.821394806625846*^9, 
   3.821394813532673*^9}, 3.82362021292198*^9, {3.823622171686693*^9, 
   3.823622172315435*^9}, {3.826637176454769*^9, 3.826637234820775*^9}, {
   3.828721770033499*^9, 3.8287218085581493`*^9}, {3.8288188770843773`*^9, 
   3.8288188916860943`*^9}, {3.830518327555119*^9, 3.830518350048956*^9}, {
   3.8642317462947273`*^9, 3.864231746294821*^9}, {3.8642323647843227`*^9, 
   3.864232378149444*^9}, {3.864235734824885*^9, 3.864235736795219*^9}, 
   3.8643257864256153`*^9, {3.864900410736802*^9, 
   3.864900413344411*^9}},ExpressionUUID->"41449220-ac3a-47b9-8393-\
160a231bd252"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"secondDr", " ", "=", " ", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"D", "[", 
     RowBox[{"partialD", " ", ",", " ", "r"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", "secondDr"}], "Input",
 CellChangeTimes->{{3.8213132406215*^9, 3.821313240624805*^9}, {
  3.821314137591223*^9, 3.8213141654220667`*^9}, {3.829575912962962*^9, 
  3.829575917530072*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"26984c46-c3a1-48b9-912a-b67f4df65554"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "6"}], " ", "c", " ", "g0", " ", 
       SuperscriptBox["m", "2"], " ", 
       SuperscriptBox["r", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"Tv", "+", 
          RowBox[{"g", " ", "Tw"}], "-", "v", "-", 
          RowBox[{"g", " ", "w"}]}], ")"}], "2"]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["m", "3"], " ", 
       SuperscriptBox["r", "3"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"Tv", "+", 
          RowBox[{"g", " ", "Tw"}], "-", "v", "-", 
          RowBox[{"g", " ", "w"}]}], ")"}], "2"]}], "+", 
      RowBox[{"6", " ", 
       SuperscriptBox["c", "2"], " ", "g0", " ", "m", " ", "r", " ", 
       RowBox[{"(", 
        RowBox[{"Tv", "+", 
         RowBox[{"g", " ", "Tw"}], "-", "v", "-", 
         RowBox[{"g", " ", "w"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g0", " ", 
          RowBox[{"(", 
           RowBox[{"Tv", "-", "v"}], ")"}]}], "+", 
         RowBox[{"g", " ", 
          RowBox[{"(", 
           RowBox[{"mu", "+", 
            RowBox[{"g0", " ", "Tw"}], "-", 
            RowBox[{"g0", " ", "w"}]}], ")"}]}]}], ")"}]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["c", "3"], " ", "g0", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g0", " ", 
           RowBox[{"(", 
            RowBox[{"Tv", "-", "v"}], ")"}]}], "+", 
          RowBox[{"g", " ", 
           RowBox[{"(", 
            RowBox[{"mu", "+", 
             RowBox[{"g0", " ", "Tw"}], "-", 
             RowBox[{"g0", " ", "w"}]}], ")"}]}]}], ")"}], "2"]}]}], ")"}], 
    " ", "zeta"}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["r", "3"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", " ", "g0", " ", 
        RowBox[{"(", 
         RowBox[{"Tv", "-", "v"}], ")"}]}], "+", 
       RowBox[{"c", " ", "g", " ", 
        RowBox[{"(", 
         RowBox[{"mu", "+", 
          RowBox[{"g0", " ", 
           RowBox[{"(", 
            RowBox[{"Tw", "-", "w"}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"m", " ", "r", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "Tv"}], "+", "v", "+", 
          RowBox[{"g", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "Tw"}], "+", "w"}], ")"}]}]}], ")"}]}]}], ")"}], 
     "3"]}], ")"}]}]], "Output",
 CellChangeTimes->{3.864900756569323*^9, 3.865026003910244*^9, 
  3.8653375756051283`*^9, 3.86534769086368*^9},
 CellLabel->"Out[19]=",ExpressionUUID->"e552d44d-c0ee-4dff-a42d-f415e65dacac"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"r", "=", "rstar"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", "secondDr", "]"}]}], "Input",
 CellChangeTimes->{{3.864900589700791*^9, 3.864900610334638*^9}, {
  3.864900764805147*^9, 3.864900767253417*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"2202a894-7dbe-40e5-856b-b971316bc277"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"2", " ", 
      SuperscriptBox["c", "2"], " ", "g", " ", "g0", " ", 
      SuperscriptBox["m", "8"], " ", "mu", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"Tv", "-", "v", "+", 
         RowBox[{"g", " ", 
          RowBox[{"(", 
           RowBox[{"Tw", "-", "w"}], ")"}]}]}], ")"}], "3"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["c", "2"], " ", "g", " ", "g0", " ", 
           SuperscriptBox["m", "2"], " ", "mu", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "Tv"}], "-", 
             RowBox[{"g", " ", "Tw"}], "+", "v", "+", 
             RowBox[{"g", " ", "w"}]}], ")"}]}]]}], "-", 
        RowBox[{"c", " ", "m", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"g0", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "Tv"}], "+", "v"}], ")"}]}], "+", 
           RowBox[{"g", " ", 
            RowBox[{"(", 
             RowBox[{"mu", "-", 
              RowBox[{"g0", " ", "Tw"}], "+", 
              RowBox[{"g0", " ", "w"}]}], ")"}]}]}], ")"}]}]}], ")"}], " ", 
      "zeta"}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", "g", " ", "m", " ", "mu"}], "+", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["c", "2"], " ", "g", " ", "g0", " ", 
           SuperscriptBox["m", "2"], " ", "mu", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "Tv"}], "-", 
             RowBox[{"g", " ", "Tw"}], "+", "v", "+", 
             RowBox[{"g", " ", "w"}]}], ")"}]}]]}], ")"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", "g0", " ", "m", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "Tv"}], "-", 
            RowBox[{"g", " ", "Tw"}], "+", "v", "+", 
            RowBox[{"g", " ", "w"}]}], ")"}]}], "+", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["c", "2"], " ", "g", " ", "g0", " ", 
           SuperscriptBox["m", "2"], " ", "mu", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "Tv"}], "-", 
             RowBox[{"g", " ", "Tw"}], "+", "v", "+", 
             RowBox[{"g", " ", "w"}]}], ")"}]}]]}], ")"}], "3"]}], ")"}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.864900614170307*^9, 3.8649007746233788`*^9, 
  3.8650260119101963`*^9, 3.8653375876945477`*^9, 3.865347699610338*^9},
 CellLabel->"Out[22]=",ExpressionUUID->"bfa1df11-2611-4022-8e11-7f184e6af8a7"]
}, Open  ]],

Cell[TextData[StyleBox["This expression is clearly negative (also supported \
by the PIP), meaning that rstar is an  ESS.",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.821285691138969*^9, 3.821285777220462*^9}, {
   3.8212919155308037`*^9, 3.821291938641271*^9}, {3.821292832378126*^9, 
   3.821292848225235*^9}, {3.821314249271508*^9, 3.8213142559962397`*^9}, 
   3.826637361926887*^9, {3.830518557605475*^9, 3.83051857949192*^9}, {
   3.864327688982883*^9, 3.864327692807579*^9}, {3.8649003666090317`*^9, 
   3.864900388857856*^9}, {3.864900792553899*^9, 3.864900795734581*^9}, {
   3.864900839057488*^9, 3.864900848559924*^9}, {3.865337591690772*^9, 
   3.8653376005984793`*^9}},ExpressionUUID->"d46d3f46-a689-403f-8870-\
06fcb3c04b69"],

Cell[TextData[{
 StyleBox["4. Virulence at optimal r* for the reservoir host\n",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 "We can also use the expression for r* to calculate an expression for \
alpha*, the  virulence experienced by the reservoir host infected with a \
virus evolved to r*. To do this, we simply plug the within-host parameters \
into our expression for alpha, assuming r=r*.\n\nThis yields the following \
expression:"
}], "Text",
 CellChangeTimes->{{3.821314501096796*^9, 3.821314536415327*^9}, {
   3.8213941608682823`*^9, 3.821394188147423*^9}, 3.82363351881653*^9, {
   3.8266373579379807`*^9, 3.826637396131752*^9}, {3.826638137012505*^9, 
   3.82663815815567*^9}, {3.826641366772573*^9, 3.826641397202518*^9}, {
   3.826641439557803*^9, 3.826641480543646*^9}, {3.830518497653351*^9, 
   3.830518529739011*^9}, {3.830518572132123*^9, 3.8305185938272457`*^9}, {
   3.8643277054520817`*^9, 3.864327725533165*^9}, {3.8649003952560997`*^9, 
   3.864900397563786*^9}},ExpressionUUID->"34eb3e73-9286-4b9e-8e48-\
0e3145af304d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"FullSimplify", "[", "alphaT", "]"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.826641421158149*^9, 3.826641421163232*^9}, {
  3.826641460675452*^9, 3.826641475535478*^9}, {3.8295763507332783`*^9, 
  3.829576355028289*^9}, {3.864900568121117*^9, 3.8649005745499563`*^9}, {
  3.864900623531273*^9, 3.8649006249765253`*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"47335de3-714b-4b42-84a5-03df97288b5e"],

Cell[BoxData[
 FractionBox[
  SqrtBox[
   RowBox[{
    SuperscriptBox["c", "2"], " ", "g", " ", "g0", " ", 
    SuperscriptBox["m", "2"], " ", "mu", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "Tv"}], "+", "v", "+", 
      RowBox[{"g", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "Tw"}], "+", "w"}], ")"}]}]}], ")"}]}]], 
  RowBox[{"c", " ", "g", " ", "m"}]]], "Output",
 CellChangeTimes->{3.8266414782764072`*^9, 3.8287218550032253`*^9, 
  3.8287271547435226`*^9, 3.828818940418009*^9, 3.8295763595046377`*^9, 
  3.8305184733192863`*^9, 3.832610867306917*^9, 3.832621843276752*^9, 
  3.8643263121914167`*^9, 3.864900506227962*^9, 3.864900628988387*^9, 
  3.864900855368149*^9, 3.865026023103457*^9, 3.865337605630392*^9, 
  3.865347706227746*^9},
 CellLabel->"Out[23]=",ExpressionUUID->"68896f0b-15f1-4b18-b042-4be8677cd4c6"]
}, Open  ]],

Cell[TextData[{
 "alpha* = ",
 Cell[BoxData[
  FractionBox[
   SqrtBox[
    RowBox[{
     SuperscriptBox["c", "2"], " ", "g", " ", "g0", " ", 
     SuperscriptBox["m", "2"], " ", "mu", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "Tv"}], "+", "v", "+", 
       RowBox[{"g", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "Tw"}], "+", "w"}], ")"}]}]}], ")"}]}]], 
   RowBox[{"c", " ", "g", " ", "m"}]]],
  CellChangeTimes->{3.8266414782764072`*^9, 3.8287218550032253`*^9, 
   3.8287271547435226`*^9, 3.828818940418009*^9, 3.8295763595046377`*^9, 
   3.8305184733192863`*^9, 3.832610867306917*^9, 3.832621843276752*^9, 
   3.8643263121914167`*^9, 3.864900506227962*^9, 3.864900628988387*^9, 
   3.864900855368149*^9},ExpressionUUID->
  "ddbd41fa-5ab1-4108-b56a-76ad48e6e8ce"]
}], "Text",
 CellChangeTimes->{{3.8266414933166037`*^9, 3.826641550746649*^9}, {
   3.828721867026031*^9, 3.828721904036846*^9}, {3.830518481940342*^9, 
   3.830518490224896*^9}, {3.8643263179049892`*^9, 3.864326317905044*^9}, {
   3.864900515374691*^9, 3.86490051537473*^9}, 3.8649015675848827`*^9, {
   3.865337610452986*^9, 
   3.865337610825389*^9}},ExpressionUUID->"a40a8415-f9af-4e5e-baa6-\
5b851405f2f5"]
},
WindowSize->{650, 871},
WindowMargins->{{184, Automatic}, {9, Automatic}},
TaggingRules->{"TryRealOnly" -> False},
FrontEndVersion->"12.3 for Mac OS X ARM (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"242ef648-6341-49a6-9bf9-b1c5719ea65d"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1007, 17, 58, "Text",ExpressionUUID->"177f5904-4ea3-452b-8b42-29a0429fe9c2"],
Cell[CellGroupData[{
Cell[1590, 41, 1476, 29, 30, "Input",ExpressionUUID->"521304a0-bb30-4678-a3fa-1888bca1bba9"],
Cell[3069, 72, 1045, 26, 53, "Output",ExpressionUUID->"4844756f-0760-4775-81b5-4938fcbfecd9"]
}, Open  ]],
Cell[4129, 101, 1701, 30, 88, "Input",ExpressionUUID->"bfab80c4-fba3-4078-988e-2ea20491d65a"],
Cell[5833, 133, 848, 15, 196, "Text",ExpressionUUID->"7e041a3d-23bf-45cb-8f20-35ddf97acb2f"],
Cell[CellGroupData[{
Cell[6706, 152, 2017, 37, 73, "Input",ExpressionUUID->"26dfaa43-d31b-4bee-9e79-e5491f8efcb2"],
Cell[8726, 191, 473, 12, 53, "Output",ExpressionUUID->"99faa22d-d13e-475b-ac4c-549f598e4783"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9236, 208, 295, 5, 30, "Input",ExpressionUUID->"176ab53c-7a5a-4559-939d-ee1620b0e7b4"],
Cell[9534, 215, 1209, 31, 53, "Output",ExpressionUUID->"6bf90735-4776-4f35-9043-76d3f5970042"]
}, Open  ]],
Cell[10758, 249, 261, 6, 58, "Text",ExpressionUUID->"dc8f89b9-7ae2-417b-b835-c009c7bba5fb"],
Cell[CellGroupData[{
Cell[11044, 259, 1051, 18, 52, "Input",ExpressionUUID->"46ee1b19-3f93-4ca9-8b06-9123cc40cf78"],
Cell[12098, 279, 1423, 36, 53, "Output",ExpressionUUID->"7e8c4160-0814-4f97-aecf-06637d4da4d3"]
}, Open  ]],
Cell[13536, 318, 524, 11, 58, "Text",ExpressionUUID->"5b869029-2c89-49a7-9abd-5a050fbf11b8"],
Cell[CellGroupData[{
Cell[14085, 333, 1976, 31, 52, "Input",ExpressionUUID->"b84430ad-d26e-41bc-a480-7b9f85f8e79a"],
Cell[16064, 366, 2684, 69, 83, "Output",ExpressionUUID->"b951dfad-1179-4416-beab-e2edd2e745d4"]
}, Open  ]],
Cell[18763, 438, 182, 3, 35, "Text",ExpressionUUID->"8c0a6322-b4b3-470b-8229-ca2cb5541f37"],
Cell[CellGroupData[{
Cell[18970, 445, 1906, 29, 30, "Input",ExpressionUUID->"374123e7-bf4e-4c65-8bbb-160d7e2734a0"],
Cell[20879, 476, 2446, 55, 125, "Output",ExpressionUUID->"a3fa38a3-7e5e-46e6-9caa-17f749d79bf3"]
}, Open  ]],
Cell[23340, 534, 2475, 45, 92, "Input",ExpressionUUID->"863f96d5-380a-4ecf-8a13-1daaab0a28d0"],
Cell[25818, 581, 1900, 30, 81, "Text",ExpressionUUID->"41449220-ac3a-47b9-8393-160a231bd252"],
Cell[CellGroupData[{
Cell[27743, 615, 480, 10, 52, "Input",ExpressionUUID->"26984c46-c3a1-48b9-912a-b67f4df65554"],
Cell[28226, 627, 2700, 79, 104, "Output",ExpressionUUID->"e552d44d-c0ee-4dff-a42d-f415e65dacac"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30963, 711, 340, 6, 52, "Input",ExpressionUUID->"2202a894-7dbe-40e5-856b-b971316bc277"],
Cell[31306, 719, 2744, 76, 158, "Output",ExpressionUUID->"bfa1df11-2611-4022-8e11-7f184e6af8a7"]
}, Open  ]],
Cell[34065, 798, 748, 11, 58, "Text",ExpressionUUID->"d46d3f46-a689-403f-8870-06fcb3c04b69"],
Cell[34816, 811, 1048, 18, 173, "Text",ExpressionUUID->"34eb3e73-9286-4b9e-8e48-0e3145af304d"],
Cell[CellGroupData[{
Cell[35889, 833, 453, 8, 52, "Input",ExpressionUUID->"47335de3-714b-4b42-84a5-03df97288b5e"],
Cell[36345, 843, 861, 20, 81, "Output",ExpressionUUID->"68896f0b-15f1-4b18-b042-4be8677cd4c6"]
}, Open  ]],
Cell[37221, 866, 1222, 29, 49, "Text",ExpressionUUID->"a40a8415-f9af-4e5e-baa6-5b851405f2f5"]
}
]
*)

